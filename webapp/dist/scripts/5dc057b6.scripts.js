"use strict";angular.module("ikelClientApp",["ngCookies","ngResource","ngSanitize","ngRoute","ui.bootstrap","ui.bootstrap.tabs"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/createOrder",{templateUrl:"views/createOrder.html",controller:"CreateOrderCtrl"}).when("/createItem/:orderId",{templateUrl:"views/createItem.html",controller:"CreateItemCtrl"}).when("/printOrder/:orderId",{templateUrl:"views/printOrder.html",controller:"PrintOrderCtrl"}).when("/deleteOrder/:orderId",{templateUrl:"views/deleteOrder.html",controller:"DeleteOrderCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("ikelClientApp").controller("MainCtrl",["$scope","Order","Item",function(a,b,c){a.orders=b.query({},function(a){a.forEach(function(a){a.items=c.query({order:a._id},function(b){a.total=b.reduce(function(a,b){return a+parseFloat(b.price||0)},0)})})}),a.deleteItem=function(a,b,c){a.$delete(function(){b.items.splice(c,1),b.total=b.items.reduce(function(a,b){return a+parseFloat(b.price||0)},0)})}}]),angular.module("ikelClientApp").factory("Order",["$resource","apiPrefix",function(a,b){var c=a(b+"/order/:id",{id:"@_id"});return c}]),angular.module("ikelClientApp").constant("apiPrefix","http://ejja-ha-nieklu.herokuapp.com"),angular.module("ikelClientApp").factory("Item",["$resource","apiPrefix",function(a,b){var c=a(b+"/item/:id",{id:"@_id"});return c}]),angular.module("ikelClientApp").controller("CreateOrderCtrl",["$scope","$location","Order",function(a,b,c){a.save=function(){c.save(a.order,function(){b.path("/")})}}]),angular.module("ikelClientApp").controller("CreateItemCtrl",["$scope","$location","$routeParams","Item",function(a,b,c,d){a.orderId=c.orderId,a.item={_order:c.orderId},a.save=function(){d.save(a.item,function(){b.path("/")})},a.saveAndAdd=function(){d.save(a.item,function(){a.item={_order:c.orderId,author:a.item.author}})}}]),angular.module("ikelClientApp").controller("PrintOrderCtrl",["$scope","$routeParams","Order","Item",function(a,b,c,d){a.order=c.get({id:b.orderId},function(a){a.items=d.query({order:a._id},function(b){a.total=b.reduce(function(a,b){return a+parseFloat(b.price||0)},0)})})}]),angular.module("ikelClientApp").controller("DeleteOrderCtrl",["$scope","$routeParams","$location","Order",function(a,b,c,d){a.order=d.get({id:b.orderId}),a.confirm=function(){a.order.$delete(function(){c.path("/")})}}]);